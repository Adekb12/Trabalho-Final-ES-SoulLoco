<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="../estilo/cardapio-gerente.css"> -->
    <link rel="stylesheet" href="../estilo/adicionar-item.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>Editar item</title>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Adiciona eventos aos botões
            document.querySelector('.btn-cancel').addEventListener('click', function () {
                window.location.href = `cardapio-gerente.html`
            });

            document.querySelector('.btn-add').addEventListener('click', function () {
                // Obtém os valores atuais dos campos do formulário
                const imagem = document.getElementById('imageInput').value;
                const nome = document.getElementById('nameInput').value;
                const descricao = document.getElementById('descriptionInput').value;
                const preco = document.getElementById('priceInput').value;

                adicionarItemNoBanco(imagem, nome, descricao, preco);
            });

            async function adicionarItemNoBanco(imagem, nome, descricao, preco) {
                try {
                    const response = await axios.post(`http://localhost:3000/cardapio`, {
                        imagem: imagem,
                        nome: nome,
                        descricao: descricao,
                        preco: preco
                    });

                    if (response.data.success) {
                        window.location.href = `cardapio-gerente.html`
                    } else {
                        if (response.data.mensagem == "Esse nome já existe!") {
                            console.log("Esse nome já existe!")
                            //tratar para aparecer uma mensagem para o usuário que o nome do item já existe
                        } else if (response.data.mensagem == "Preço inválido!") {
                            console.log("Preço inválido!!!")
                            //tratar para aparecer uma mensagem para o usuário que o preço é inválido
                        } else {
                            console.error('Erro no login:', response.data.mensagem);
                        }

                    }
                } catch (error) {
                    console.error('Erro na requisição:', error);
                }
            }
        });
    </script>
</head>

<body>
    <header>
        <div class="bem-vindo" id="container">
            <div class="bem-vindo">
                <p id="laranja">
                    Bem-vindo ao Soul Loco!<br>
                    Aqui o sabor vem com a alma mexicana <br> <br>
                </p>
                <p class="bem-vindo-text">
                    Selecione os itens que você gostaria de pedir e clique em <br>
                    "Visualizar Detalhes do Pedido" para realizar o pedido
                </p>
            </div>
        </div>
        <div id="menu">
            <form method="post">
                <p>
                    <button onclick=""><img class="icone" src="../imagens/botao-logout.png" alt="Sair"></button><br><br><br>
                </p>
            </form>
        </div>
    </header>
    <main>
        <div class="edit-window">
            <h2>Adicione as informações do item</h2>

            <!-- Campo para inserir a imagem ou o caminho -->
            <div class="form-group">
                <label for="imageInput">Caminho(URL) da imagem:</label>
                <input type="text" id="imageInput" name="imageInput">
            </div>

            <!-- Formulário com a classe "form-container" adicionada -->
            <div class="form-container">
                <div class="form-group">
                    <label for="nameInput">Nome:</label>
                    <input type="text" id="nameInput" name="nameInput">
                </div>

                <div class="form-group">
                    <label for="descriptionInput">Descrição:</label>
                    <input type="text" id="descriptionInput" name="descriptionInput">
                </div>

                <div class="form-group">
                    <label for="priceInput">Preço:</label>
                    <input type="text" id="priceInput" name="priceInput">
                </div>
            </div>

            <!-- Botões -->
            <div class="btn-container">
                <div class="btn-cancel">Cancelar</div>
                <div class="btn-add">Adicionar</div>
            </div>
        </div>
    </main>
</body>

</html>